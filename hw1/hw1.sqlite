# Q1
SELECT DISTINCT DraftFrom 
FROM Draft 
WHERE FirstName = "Lew" AND LastName = "Alcindor";


#Q2
SELECT DISTINCT T.Name 
FROM Teams AS T, Players AS P 
WHERE P.TeamID = T.TeamID AND P.PlayerID = "abdulka01";


#Q3
SELECT COUNT(*) FROM 
	(SELECT TeamID 
	 FROM Players 
	 WHERE PlayerID = "abdulka01" 
	 GROUP BY TeamID);


#Q4
SELECT m.FirstName, m.LastName 
FROM AllStar AS a, Master AS m
WHERE a.PlayerID = m.BioID and m.college = "California"
GROUP BY m.FirstName, m.LastName 
HAVING count(*) >= 3
ORDER BY m.LastName;


#Q5a
SELECT m.FirstName, m.LastName, p.TeamID, COUNT(*) 
FROM (select distinct PlayerID, TeamID from Players) AS p, Master AS m 
WHERE p.PlayerID = m.BioID 
GROUP BY p.PlayerID 
HAVING COUNT(*) = 1 
ORDER BY m.LastName;


#Q5b
SELECT TeamID, count(*) FROM 
	(SELECT m.FirstName, m.LastName, p.TeamID, COUNT(*) 
	FROM (select distinct PlayerID, TeamID from Players) AS p, Master AS m 
	WHERE p.PlayerID = m.BioID 
	GROUP BY p.PlayerID 
	HAVING COUNT(*) = 1 
	ORDER BY m.LastName)
GROUP BY TeamID ORDER BY COUNT(*) DESC LIMIT 5;


#Q6
SELECT m.FirstName, m.LastName, (1.0 * p.FGMade / p.FGAttempted) AS FGPercentage 
FROM Players AS p, Master AS M 
WHERE p.PlayerID = m.BioID AND p.FGAttempted >= 1000 
ORDER BY FGPercentage DESC 
LIMIT 10;


#Q7
SELECT m.FirstName, m.LastName, SUM(c.PostWins) 
FROM Coaches AS c, Master AS M 
WHERE c.CoachID = m.BioID  
GROUP BY c.CoachID 
HAVING SUM(c.PostWins) >= 100;


#Q8 -- Working
SELECT p.PlayerID from Players AS P, 
	(SELECT PlayerID, COUNT(*) AS AllStarGamesPlayed FROM AllStar GROUP BY PlayerID) AS a 
WHERE p.PlayerID = a.PlayerID AND a.AllStarGamesPlayed >= 8 
GROUP BY p.PlayerID HAVING MAX(p.Year) < 2010 
EXCEPT 
SELECT hofID FROM HallOfFame;


#Q9 -- Working
SELECT i.TeamID, (cCount + pCount) AS awardsCount FROM
 
	(SELECT p.TeamID, COUNT(*) AS pCount 
	FROM Players AS p, AwardsPlayers AS ap 
	WHERE p.PlayerID = ap.PlayerID AND p.Year = ap.Year 
	GROUP BY p.TeamID) AS i,

	(SELECT c.TeamID, COUNT(*) AS cCount
	FROM Coaches AS c, AwardsCoaches AS ac
	WHERE c.CoachID = ac.CoachID AND c.Year = ac.Year 
	GROUP BY c.TeamID) AS j

WHERE i.TeamID = j.TeamID 
ORDER BY awardsCount DESC
LIMIT 5;









